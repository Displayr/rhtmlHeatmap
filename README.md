An improved heatmap package based on d3heatmap.

Example Usage in R
-------

    devtools::install_github("Displayr/rhtmlHeatmap")
    library(rhtmlHeatmap)
    Heatmap(mtcars, scale="column", colors="Blues")

Features
-------
This heatmap package contains a number of features that improve on d3heatmap.
Some examples are shown in the examples folder.

1. Allows changing axis location by setting xaxis_location or yaxis_location.
2. Attaches a legend by default when scale = "none". Can be disabled by setting show_legend = FALSE.
3. Can attach a title and a footer with auto text wrapping.
4. Can display only the lower triangle by setting lower_triangle = TRUE.
5. Can hide custom cells.
6. Can specify custom color range values.

Developing and Contributing
-------

rhtmlHeatmap relies heavily on [rhtmlBuildUtils](https://github.com/Displayr/rhtmlBuildUtils). You should read through the docs in the rhtmlBuildUtils repo to understand:
 
 1. which gulp tasks are available
 1. the constraints on file layout in your widget project
 1. How to perform visual testing.
 
 Here are a few important notes (both detailed in the rhtmlBuildUtils docs) you must keep in mind:

1. The last thing you do before committing is run `gulp build` to ensure all the autogenerated files are up to date.
2. (With some exceptions) ONLY EDIT THINGS IN these directories: `theSrc`, `bdd`, `docs`, and sometimes `build` !! Many of the other files are auto generated based on the contents of `theSrc`. As an example, if you edit `R/rhtmlTemplate.R` and then run `gulp build` your changes will be DELETED FOREVER!, because `R/rhtmlTemplate.R` is just a copy of `theSrc/R/htmlwidget.R`. See [htmlwidget_build_system](docs/htmlwidget_build_system.md) for more details.

### Contributing to rhtmlHeatmap
1. Do not work in master, as the master branch of rhtmlTemplate is used to verify the R server build process.
1. Create a branch, make some changes, add test for your changes, update the docs if necessary, push your branch, and create a pull request on github.

### How the git prepush hook works (aka: My git push got rejected ?!)

This project uses the npm [husky](https://github.com/typicode/husky) module to add git lifecycle hooks to the project. These are defined in the `scripts` section of the [package.json](./package.json) file.
 
Of particular interest is the `prepush` entry which runs a script that checks the project code style using the `gulp lint` command. If there are errors, then it will reject your git push command. You have two options:
  
1. Fix the errors and try pushing again. To see which errors are in the code run `gulp lint`. To autofix as many as possible run `gulp lint --fix`; this will only report the errors it could not auto-fix. Don't forget to commit your code again before pushing.
1. If you must (not recommended) add a --no-verify (i.e., `git push origin head --no-verify`) to skip the style checking.

Here is an illustrative sequence:

```bash
$ git push origin head

> husky - npm run -s prepush

...

/Users/kyle/projects/numbers/rhtmlTemplate/bdd/steps/loadThePage.steps.js
  8:47  error  Missing semicolon  semi

âœ– 1 problem (1 error, 0 warnings)

[17:50:09] 'lint' errored after 4.85 s

...

$ gulp lint --fix
[17:50:16] Starting 'lint'...
[17:50:21] Finished 'lint' after 4.94 s

$ git commit -a -m 'fix the style'
...

$ git push origin head
```

### Layout considerations

#### wrapping complications

The xaxis, title, subtitle, footer, and yaxis_title components all support text wrapping when needed, but this complicates the layout.
If wrapping is required then these components take up extra height (or width in the case of the vertically oriented yaxis title).

For the xaxis, title, subtitle, footer : To know the required height (due to wrapping), we need to know the available width to determine if wrapping is required.

For the yaxis_title : To know the required width (due to wrapping), we need to know the available height to determine if wrapping is required.

But the height available to the yaxis_title is partially determined by how much wrapping occurs in the title, subtitle, and footer.
And the amount of wrapping in the title/subtitle/footer depends on the width available, which is partially determined by the amount of wrapping in the yaxis_title.

As you can see this is a cyclic dependency. The chosen solution is a tradeoff which favors the wrapping of the title/subtitle/footer over the wrapping of the yaxis_title
    
### Title/Subtitle/Footer Alignment and wrapping complications
    
We center align the title/subtitle/footer with the midpoint of the heatmap,
 but we want to wrap these text components using the canvas boundaries, not the colormap boundaries. 

The layout component does not currently support that use case, so there are some manual steps performed in heatmapcore.js to accomodate this use case.

License
-------
GPL-3
